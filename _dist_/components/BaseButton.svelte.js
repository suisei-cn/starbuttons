import"./BaseButton.svelte.css.proxy.js";import{SvelteComponent as P,action_destroyer as S,append as W,attr as _,binding_callbacks as F,component_subscribe as b,detach as H,element as O,init as T,insert as q,listen as h,noop as B,run_all as z,safe_not_equal as M,set_data as N,set_style as k,text as R,toggle_class as r}from"../../_snowpack/pkg/svelte/internal.js";import{getContext as G,onMount as D}from"../../_snowpack/pkg/svelte.js";import{format as J,locale as U}from"../../_snowpack/pkg/svelte-i18n.js";import V from"../config.js";import{GLOBAL_DEFAULT_LANG as K,ln as Q}from"../utils/i18n.js";import{longPressOrRightClick as X}from"../actions/longPressOrRightClick.js";function Y(s){let e,i,f,l,a;return{c(){e=O("div"),i=R(s[7]),_(e,"class","baseBtn stylizedBtn svelte-15wzsey"),k(e,"min-width",s[6]),_(e,"tabindex","0"),r(e,"active",s[2]!==0),r(e,"baseBtnInList",s[0]),r(e,"pending",s[3]),r(e,"testHoverWidth",s[4])},m(o,n){q(o,e,n),W(e,i),s[11](e),l||(a=[S(f=X.call(null,e)),h(e,"long-press",s[8]),h(e,"click",s[1]),h(e,"keypress",s[1])],l=!0)},p(o,[n]){n&128&&N(i,o[7]),n&64&&k(e,"min-width",o[6]),n&4&&r(e,"active",o[2]!==0),n&1&&r(e,"baseBtnInList",o[0]),n&8&&r(e,"pending",o[3]),n&16&&r(e,"testHoverWidth",o[4])},i:B,o:B,d(o){o&&H(e),s[11](null),l=!1,z(a)}}}function Z(s,e,i){let f,l,a;b(s,J,t=>i(12,l=t)),b(s,U,t=>i(10,a=t));const o=V.assets_path;let{item:n}=e,{baseBtnInList:m=!0}=e,L=G("player"),u=0,p=!1,d=!1,c,g="0px";function A(){return Array.isArray(n.file)?n.file[Math.floor(Math.random()*n.file.length)]:n.file}function w(){const t=c.offsetWidth;if(!t){requestAnimationFrame(w);return}i(6,g=String(t-16+"px")),i(4,d=!1)}function y(){i(6,g="0px"),i(4,d=!0),requestAnimationFrame(w)}function C(){i(3,p=!0);const t=L.addAudio(o+A()),E=setTimeout(()=>{window.errorFormatter?.(l("Voices are still loading. Please be patient..."))},1500);t.addEventListener("play",()=>{i(2,u++,u)}),t.addEventListener("pause",()=>{i(2,u--,u)}),t.play().then(()=>{i(3,p=!1),clearTimeout(E)}).catch(I=>{window?.errorFormatter?.(l("Error in the playback:")+" "+String(I))})}function j(){const t={title:f,audios:Array.isArray(n.file)?n.file:[n.file]};window.dispatchEvent(new CustomEvent("showb64window",{detail:JSON.stringify(t)}))}D(()=>{m&&(y(),window.addEventListener("languagechange",y))});function v(t){F[t?"unshift":"push"](()=>{c=t,i(5,c)})}return s.$$set=t=>{"item"in t&&i(9,n=t.item),"baseBtnInList"in t&&i(0,m=t.baseBtnInList)},s.$$.update=()=>{if(s.$$.dirty&1536){e:i(7,f=Q(a||K,n))}},[m,C,u,p,d,c,g,f,j,n,a,v]}class x extends P{constructor(e){super();T(this,e,Z,Y,M,{item:9,baseBtnInList:0,playSound:1})}get playSound(){return this.$$.ctx[1]}}export default x;
