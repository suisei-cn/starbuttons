import"./Board.svelte.css.proxy.js";import{SvelteComponent as ee,add_render_callback as U,append as B,attr as p,check_outros as y,component_subscribe as A,create_bidirectional_transition as C,create_component as N,destroy_component as E,destroy_each as G,detach as m,element as k,empty as P,group_outros as j,init as te,insert as g,mount_component as $,safe_not_equal as le,set_data as S,space as F,text as L,toggle_class as q,transition_in as d,transition_out as b}from"../../_snowpack/pkg/svelte/internal.js";import{createEventDispatcher as oe}from"../../_snowpack/pkg/svelte.js";import{fade as M}from"../../_snowpack/pkg/svelte/transition.js";import{format as ne,locale as re,_ as se}from"../../_snowpack/pkg/svelte-i18n.js";import{GLOBAL_DEFAULT_LANG as W,ln as D}from"../utils/i18n.js";import z from"./BaseButton.svelte.js";function O(a,t,l){const o=a.slice();return o[13]=t[l],o}function V(a,t,l){const o=a.slice();return o[16]=t[l],o}function I(a,t,l){const o=a.slice();return o[13]=t[l],o}function ie(a){let t,l,o,f;return l=new z({props:{item:a[6],baseBtnInList:!1}}),{c(){t=k("div"),N(l.$$.fragment),p(t,"id","bigBtn"),p(t,"class","boardPart svelte-1q167vd"),p(t,"tabindex","0"),q(t,"wideMode",a[2])},m(s,u){g(s,t,u),$(l,t,null),f=!0},p(s,u){const c={};u&64&&(c.item=s[6]),l.$set(c),(!f||u&4)&&q(t,"wideMode",s[2])},i(s){f||(d(l.$$.fragment,s),U(()=>{o||(o=C(t,M,{},!0)),o.run(1)}),f=!0)},o(s){b(l.$$.fragment,s),o||(o=C(t,M,{},!1)),o.run(0),f=!1},d(s){s&&m(t),E(l),s&&o&&o.end()}}}function fe(a){let t,l,o,f,s,u=a[3],c=[];for(let e=0;e<u.length;e+=1)c[e]=H(V(a,u,e));const i=e=>b(c[e],1,1,()=>{c[e]=null});let _=a[4].length&&J(a);return{c(){t=k("div"),l=k("div");for(let e=0;e<c.length;e+=1)c[e].c();o=F(),_&&_.c(),p(l,"id","boardContext"),p(l,"class","svelte-1q167vd"),p(t,"id","board"),p(t,"class","boardPart svelte-1q167vd"),q(t,"wideMode",a[2])},m(e,n){g(e,t,n),B(t,l);for(let r=0;r<c.length;r+=1)c[r].m(l,null);B(l,o),_&&_.m(l,null),s=!0},p(e,n){if(n&168){u=e[3];let r;for(r=0;r<u.length;r+=1){const h=V(e,u,r);c[r]?(c[r].p(h,n),d(c[r],1)):(c[r]=H(h),c[r].c(),d(c[r],1),c[r].m(l,o))}for(j(),r=u.length;r<c.length;r+=1)i(r);y()}e[4].length?_?(_.p(e,n),n&16&&d(_,1)):(_=J(e),_.c(),d(_,1),_.m(l,null)):_&&(j(),b(_,1,1,()=>{_=null}),y()),(!s||n&4)&&q(t,"wideMode",e[2])},i(e){if(!s){for(let n=0;n<u.length;n+=1)d(c[n]);d(_),U(()=>{f||(f=C(t,M,{},!0)),f.run(1)}),s=!0}},o(e){c=c.filter(Boolean);for(let n=0;n<c.length;n+=1)b(c[n]);b(_),f||(f=C(t,M,{},!1)),f.run(0),s=!1},d(e){e&&m(t),G(c,e),_&&_.d(),e&&f&&f.end()}}}function R(a){let t,l;return t=new z({props:{item:a[13]}}),{c(){N(t.$$.fragment)},m(o,f){$(t,o,f),l=!0},p(o,f){const s={};f&8&&(s.item=o[13]),t.$set(s)},i(o){l||(d(t.$$.fragment,o),l=!0)},o(o){b(t.$$.fragment,o),l=!1},d(o){E(t,o)}}}function H(a){let t,l=D(a[7]||W,a[5][a[16].slug])+"",o,f,s,u,c=a[16].sounds,i=[];for(let e=0;e<c.length;e+=1)i[e]=R(I(a,c,e));const _=e=>b(i[e],1,1,()=>{i[e]=null});return{c(){t=k("h2"),o=L(l),f=F();for(let e=0;e<i.length;e+=1)i[e].c();s=P(),p(t,"class","svelte-1q167vd")},m(e,n){g(e,t,n),B(t,o),g(e,f,n);for(let r=0;r<i.length;r+=1)i[r].m(e,n);g(e,s,n),u=!0},p(e,n){if((!u||n&168)&&l!==(l=D(e[7]||W,e[5][e[16].slug])+"")&&S(o,l),n&8){c=e[16].sounds;let r;for(r=0;r<c.length;r+=1){const h=I(e,c,r);i[r]?(i[r].p(h,n),d(i[r],1)):(i[r]=R(h),i[r].c(),d(i[r],1),i[r].m(s.parentNode,s))}for(j(),r=c.length;r<i.length;r+=1)_(r);y()}},i(e){if(!u){for(let n=0;n<c.length;n+=1)d(i[n]);u=!0}},o(e){i=i.filter(Boolean);for(let n=0;n<i.length;n+=1)b(i[n]);u=!1},d(e){e&&m(t),e&&m(f),G(i,e),e&&m(s)}}}function J(a){let t,l=a[8]("Uncategorized")+"",o,f,s,u,c=a[4],i=[];for(let e=0;e<c.length;e+=1)i[e]=K(O(a,c,e));const _=e=>b(i[e],1,1,()=>{i[e]=null});return{c(){t=k("h2"),o=L(l),f=F();for(let e=0;e<i.length;e+=1)i[e].c();s=P(),p(t,"class","svelte-1q167vd")},m(e,n){g(e,t,n),B(t,o),g(e,f,n);for(let r=0;r<i.length;r+=1)i[r].m(e,n);g(e,s,n),u=!0},p(e,n){if((!u||n&256)&&l!==(l=e[8]("Uncategorized")+"")&&S(o,l),n&16){c=e[4];let r;for(r=0;r<c.length;r+=1){const h=O(e,c,r);i[r]?(i[r].p(h,n),d(i[r],1)):(i[r]=K(h),i[r].c(),d(i[r],1),i[r].m(s.parentNode,s))}for(j(),r=c.length;r<i.length;r+=1)_(r);y()}},i(e){if(!u){for(let n=0;n<c.length;n+=1)d(i[n]);u=!0}},o(e){i=i.filter(Boolean);for(let n=0;n<i.length;n+=1)b(i[n]);u=!1},d(e){e&&m(t),e&&m(f),G(i,e),e&&m(s)}}}function K(a){let t,l;return t=new z({props:{item:a[13]}}),{c(){N(t.$$.fragment)},m(o,f){$(t,o,f),l=!0},p(o,f){const s={};f&16&&(s.item=o[13]),t.$set(s)},i(o){l||(d(t.$$.fragment,o),l=!0)},o(o){b(t.$$.fragment,o),l=!1},d(o){E(t,o)}}}function Q(a){let t;function l(s,u){if(s[0]===0)return ue;if(s[0]===-1)return ce}let o=l(a,-1),f=o&&o(a);return{c(){t=k("div"),f&&f.c(),p(t,"id","placeholder"),p(t,"class","svelte-1q167vd")},m(s,u){g(s,t,u),f&&f.m(t,null)},p(s,u){o===(o=l(s,u))&&f?f.p(s,u):(f&&f.d(1),f=o&&o(s),f&&(f.c(),f.m(t,null)))},d(s){s&&m(t),f&&f.d()}}}function ce(a){let t,l=a[8]("Failed to fetch sounds list. Please try refreshing.")+"",o,f,s,u=a[8]("But Watame did nothing wrong!")+"",c;return{c(){t=k("p"),o=L(l),f=F(),s=k("p"),c=L(u),p(t,"class","svelte-1q167vd"),p(s,"class","small svelte-1q167vd")},m(i,_){g(i,t,_),B(t,o),g(i,f,_),g(i,s,_),B(s,c)},p(i,_){_&256&&l!==(l=i[8]("Failed to fetch sounds list. Please try refreshing.")+"")&&S(o,l),_&256&&u!==(u=i[8]("But Watame did nothing wrong!")+"")&&S(c,u)},d(i){i&&m(t),i&&m(f),i&&m(s)}}}function ue(a){let t,l=a[8]("Loading...")+"",o;return{c(){t=k("p"),o=L(l),p(t,"class","svelte-1q167vd")},m(f,s){g(f,t,s),B(t,o)},p(f,s){s&256&&l!==(l=f[8]("Loading...")+"")&&S(o,l)},d(f){f&&m(t)}}}function ae(a){let t,l,o,f,s,u;const c=[fe,ie],i=[];function _(n,r){return n[1]?0:1}l=_(a,-1),o=i[l]=c[l](a);let e=a[0]!==1&&Q(a);return{c(){t=k("div"),o.c(),f=F(),e&&e.c(),s=P(),p(t,"id","boardWrapper"),p(t,"class","svelte-1q167vd"),q(t,"wideView",a[2])},m(n,r){g(n,t,r),i[l].m(t,null),g(n,f,r),e&&e.m(n,r),g(n,s,r),u=!0},p(n,[r]){let h=l;l=_(n,r),l===h?i[l].p(n,r):(j(),b(i[h],1,1,()=>{i[h]=null}),y(),o=i[l],o?o.p(n,r):(o=i[l]=c[l](n),o.c()),d(o,1),o.m(t,null)),(!u||r&4)&&q(t,"wideView",n[2]),n[0]!==1?e?e.p(n,r):(e=Q(n),e.c(),e.m(s.parentNode,s)):e&&(e.d(1),e=null)},i(n){u||(d(o),u=!0)},o(n){b(o),u=!1},d(n){n&&m(t),i[l].d(),n&&m(f),e&&e.d(n),n&&m(s)}}}function _e(a,t){const l={},o=[];for(const u of a.filter(c=>c.type!=="center")){if(!u.category){o.push(u);continue}Array.isArray(u.category)||(u.category=[u.category]);for(const c of u.category)l[c]||(l[c]=[]),l[c].push(u)}const f=Object.entries(l).sort((u,c)=>(t[u[0]]?.order||999)-(t[c[0]]?.order||999)),s=[];for(const u of f)s.push({slug:u[0],sounds:u[1]});return[s,o]}function de(a,t,l){let o,f,s;A(a,ne,w=>l(11,o=w)),A(a,re,w=>l(7,f=w)),A(a,se,w=>l(8,s=w));let u=0,c=!1,i,_=[],e=[],n={},r={name:"",file:"",type:"center"};const h=oe();function X(){l(1,c=!c),setTimeout(()=>{l(2,i=c),setTimeout(()=>{h("changeok")},250)},0)}async function Y(w){const T=await fetch(w.sounds).then(v=>v.json()).catch(v=>{l(0,u=-1);const x=new Event("loadfailed");return window.dispatchEvent(x),window?.errorFormatter?.(o("Sound list fetch error:")+" "+String(v)),console.error("Failed to fetch sounds"),[]});u!==-1&&l(0,u=1),l(5,n=await fetch(w.categories).then(v=>v.json()).catch(v=>(window?.errorFormatter?.(o("Categories fetch error:")+" "+String(v)),console.error("Failed to fetch categories"),{})));const Z=T.filter(v=>v.type!=="center");l(3,[_,e]=_e(Z,n),_,l(4,e)),l(6,r=T.filter(v=>v.type==="center")[0]),!r&&u===1&&l(1,c=!0)}return[u,c,i,_,e,n,r,f,s,X,Y]}class pe extends ee{constructor(t){super();te(this,t,de,ae,le,{toggleBoard:9,load:10})}get toggleBoard(){return this.$$.ctx[9]}get load(){return this.$$.ctx[10]}}export default pe;
